@page
@model EasyLearn.Pages.TrainingModules.CreateModel

<style>
    body {
        background-color: #0A082D;
    }
</style>

<h2 class="create-title">Створити модуль із картками</h2>

<form method="post">
    <div class="form-group">
        <label asp-for="Name" class="control-label"></label>
        <input asp-for="Name" class="form-control" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Description" class="control-label"></label>
        <input asp-for="Description" class="form-control" />
        <span asp-validation-for="Description" class="text-danger"></span>
    </div>

    <div id="cards-container">
        <div class="card-box">
            <div class="form-group">
                <label>Term</label>
                <input type="text" name="Cards[0].Term" class="form-control" />
            </div>
            <div class="form-group">
                <label>Definition</label>
                <input type="text" name="Cards[0].Definition" class="form-control" />
            </div>
        </div>
    </div>

    <button type="button" class="btn btn-secondary" id="add-card">Додати картку</button>

    <div class="form-group mt-3">
        <input type="submit" value="Create" class="btn btn-primary" />
    </div>
</form>
<

@section Scripts {
    <script>
        let cardIndex = 1;

        document.getElementById('add-card').addEventListener('click', function () {
            let container = document.getElementById('cards-container');

            // Отримуємо останню картку
            let lastCard = container.querySelector(`.card-box:nth-child(${cardIndex})`);

            // Перевіряємо, чи існує картка і чи її поля заповнені
            if (lastCard) {
                let lastTerm = lastCard.querySelector('input[name^="Cards"][name$=".Term"]').value;
                let lastDefinition = lastCard.querySelector('input[name^="Cards"][name$=".Definition"]').value;

                if (lastTerm.trim() === "" || lastDefinition.trim() === "") {
                    alert('Please fill in the term and definition fields before adding a new card.');
                    return;
                }
            }

            // Якщо всі поля заповнені, додаємо нову картку
            let cardHtml = `
                        <div class="card-box">
                            <div class="form-group">
                                <label>Term</label>
                                <input type="text" name="Cards[${cardIndex}].Term" class="form-control" />
                            </div>
                            <div class="form-group">
                                <label>Definition</label>
                                <input type="text" name="Cards[${cardIndex}].Definition" class="form-control" />
                            </div>
                        </div>`;
            container.insertAdjacentHTML('beforeend', cardHtml);
            cardIndex++;
        });
    </script>

    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}

